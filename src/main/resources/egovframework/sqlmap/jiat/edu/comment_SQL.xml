<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="eduComment">

    <!-- 특정 게시글의 댓글 목록 조회 -->
    <select id="selectCommentsByBoardId" parameterType="long" resultType="egovframework.com.cms.edu.model.CommentVO">
        SELECT 
            id,
            board_id as boardId,
            content,
            writer,
            created_at as createdAt
        FROM edu_comment
        WHERE board_id = #{boardId}
        ORDER BY created_at ASC
    </select>

    <!-- 댓글 등록 -->
    <insert id="insertComment" parameterType="egovframework.com.cms.edu.model.CommentVO" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO edu_comment (
            board_id,
            content,
            writer,
            created_at
        ) VALUES (
            #{boardId},
            #{content},
            #{writer},
            NOW()
        )
    </insert>

    <!-- 댓글 삭제 -->
    <delete id="deleteComment" parameterType="long">
        DELETE FROM edu_comment
        WHERE id = #{id}
    </delete>

    <!-- 댓글 수정 -->
    <update id="updateComment" parameterType="egovframework.com.cms.edu.model.CommentVO">
        UPDATE edu_comment
        SET content = #{content}
        WHERE id = #{id}
    </update>

    <!-- 댓글 수 조회 -->
    <select id="selectCommentCount" parameterType="long" resultType="int">
        SELECT COUNT(*)
        FROM edu_comment
        WHERE board_id = #{boardId}
    </select>

</mapper>

